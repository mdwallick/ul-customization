<!DOCTYPE html>
<html lang="{{locale}}">
  <head>
    {%- auth0:head -%}

    <link
      rel="stylesheet"
      href="https://storage.googleapis.com/acul/light-dark-mode.css"
    />

    <style>
      #custom-prompt-logo {
        background-image: var(--icon-auth0-badge);
      }
    </style>

    <title>Welcome to {{ application.name }}</title>
  </head>

  <body class="_widget-auto-layout _use-custom-prompt-logo">
    <div class="toggle-wrapper">
      <div id="darkModeToggle" class="toggle">
        <span class="icon sun">ðŸŒž</span>
        <span class="icon moon">ðŸŒ™</span>
      </div>
    </div>

    {%- auth0:widget -%}
    <script>
      const root = document.documentElement
      const userPref = localStorage.getItem("theme")
      const systemPrefersDark = window.matchMedia(
        "(prefers-color-scheme: dark)"
      ).matches

      // Apply user preference, or fall back to system preference
      if (userPref === "dark" || (!userPref && systemPrefersDark)) {
        root.classList.add("dark")
      }

      const toggle = document.getElementById("darkModeToggle")

      function updateToggleUI() {
        if (root.classList.contains("dark")) {
          toggle.classList.add("dark")
          localStorage.setItem("theme", "dark")
        } else {
          toggle.classList.remove("dark")
          localStorage.setItem("theme", "light")
        }
      }

      toggle.addEventListener("click", () => {
        root.classList.toggle("dark")
        updateToggleUI()
      })

      // Initialize based on current class
      updateToggleUI()
    </script>
  </body>
</html>
